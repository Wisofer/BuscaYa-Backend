<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - BuscaYa Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body class="bg-base-200">
    <div class="drawer lg:drawer-open">
        <input id="drawer-toggle" type="checkbox" class="drawer-toggle" />
        
        <!-- Sidebar -->
        <div class="drawer-side">
            <label for="drawer-toggle" class="drawer-overlay"></label>
            <aside class="w-64 min-h-full bg-base-300">
                <div class="p-4 border-b border-base-content/10">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        <i class="bi bi-shop"></i>
                        BuscaYa Admin
                    </h2>
                </div>
                <ul class="menu p-4 w-full">
                    <li>
                        <a href="/admin/dashboard" class="@(ViewContext.RouteData.Values["action"]?.ToString() == "Dashboard" ? "active" : "")">
                            <i class="bi bi-speedometer2"></i>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="/admin/usuarios" class="@(ViewContext.RouteData.Values["action"]?.ToString()?.Contains("Usuario") == true ? "active" : "")">
                            <i class="bi bi-people"></i>
                            Usuarios
                        </a>
                    </li>
                    <li>
                        <a href="/admin/tiendas" class="@(ViewContext.RouteData.Values["action"]?.ToString()?.Contains("Tienda") == true ? "active" : "")">
                            <i class="bi bi-shop"></i>
                            Tiendas
                        </a>
                    </li>
                    <li>
                        <a href="/admin/reportes" class="@(ViewContext.RouteData.Values["action"]?.ToString()?.Contains("Reporte") == true ? "active" : "")">
                            <i class="bi bi-flag"></i>
                            Reportes
                            @if (ViewBag.TotalNoRevisados != null && ViewBag.TotalNoRevisados > 0)
                            {
                                <span class="badge badge-error badge-sm">@ViewBag.TotalNoRevisados</span>
                            }
                        </a>
                    </li>
                    <li>
                        <a href="/admin/notifications" class="@(ViewContext.RouteData.Values["action"]?.ToString() == "Notifications" ? "active" : "")">
                            <i class="bi bi-bell"></i>
                            Notificaciones
                        </a>
                    </li>
                    <li>
                        <a href="/admin/configuraciones" class="@(ViewContext.RouteData.Values["action"]?.ToString() == "Configuraciones" ? "active" : "")">
                            <i class="bi bi-gear"></i>
                            Configuraciones
                        </a>
                    </li>
                    <li class="mt-auto pt-4 border-t border-base-content/10">
                        <a href="/logout" onclick="event.preventDefault(); document.getElementById('logoutForm').submit();" class="text-error">
                            <i class="bi bi-box-arrow-right"></i>
                            Cerrar Sesi√≥n
                        </a>
                    </li>
                </ul>
            </aside>
        </div>

        <!-- Main Content -->
        <div class="drawer-content flex flex-col">
            <!-- Navbar -->
            <div class="navbar bg-base-100 shadow-lg">
                <div class="flex-none lg:hidden">
                    <label for="drawer-toggle" class="btn btn-square btn-ghost">
                        <i class="bi bi-list text-2xl"></i>
                    </label>
                </div>
                <div class="flex-1">
                    <h1 class="text-xl font-bold">@ViewData["Title"]</h1>
                </div>
                <div class="flex-none">
                    <div class="flex items-center gap-2">
                        <i class="bi bi-person-circle text-2xl"></i>
                        <span class="hidden sm:inline">@(User.FindFirst("NombreCompleto")?.Value ?? User.Identity?.Name ?? "Admin")</span>
                    </div>
                </div>
            </div>

            <!-- Page Content -->
            <div class="p-6">
                @if (TempData["Mensaje"] != null)
                {
                    <div class="alert alert-success mb-4">
                        <i class="bi bi-check-circle"></i>
                        <span>@TempData["Mensaje"]</span>
                    </div>
                }

                @if (TempData["Error"] != null)
                {
                    <div class="alert alert-error mb-4">
                        <i class="bi bi-exclamation-circle"></i>
                        <span>@TempData["Error"]</span>
                    </div>
                }

                @RenderBody()
            </div>
        </div>
    </div>

    <form id="logoutForm" method="post" action="/logout" style="display: none;">
        @Html.AntiForgeryToken()
    </form>

    @RenderSection("Scripts", required: false)
</body>
</html>
